                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            using namespace std;

class leapFrog
     {public:
      double **u;
      double t_range;
      double dt;
      int Nt;
      
      leapFrog(double t_range, double dt)
            {this->t_range = t_range;
             this->dt = dt;
             
             Nt = ceil(t_range/dt)+ 1;
             u = new double*[Nt];
             for(int i=0; i<Nt; ++i)
                {u[i] = new double[5];
                 }             
             }

      ~leapFrog()
            {for(int i=0; i<Nt; ++i)
                 delete[] u[i];
             delete[] u;
             }
      
      void solver(void (*acc)(double x, double y, double arr[]))
            {double arr[2];
             u[0][0]=0;
             double vx_bhalf, vy_bhalf;
             
             for(int n=1; n<Nt; ++n)
                {u[n][0] = u[n-1][0] + dt;

                 acc(u[n-1][1], u[n-1][2], arr);
                 vx_bhalf = u[n-1][3] + arr[0]*dt/2;
                 vy_bhalf = u[n-1][4] + arr[1]*dt/2;

                 
                 u[n][1] = u[n-1][1] + vx_bhalf*dt;
                 u[n][2] = u[n-1][2] + vy_bhalf*dt;
 
                 acc(u[n][1], u[n][2], arr);
                 u[n][3] = vx_bhalf + arr[0]*dt/2;
                 u[n][4] = vy_bhalf + arr[1]*dt/2;
                 }
             }
      };
//leapFrog class ends

class RKSolver
     {public:
      long double **u, *IC;
      double t_range;
      long double dt;
      int Nt;
 
      RKSolver(double t_range, long double dt)
            {this->t_range = t_range;
             this->dt = dt;

             IC = new long double[5];
             u = new long double*[2];
             u[0] = new long double[5];
             u[1] = new long double[5];
             
             Nt = ceil(t_range/dt)+ 1;
             /*u = new long double*[Nt];
             for(int i=0; i<Nt; ++i)
                {u[i] = new long double[5];
                 }*/             
             }

      ~RKSolver()
            {for(int i=0; i<2; ++i)
                 delete[] u[i];
             delete[] u;
             delete IC;
             }
     
      void setInitialVal(long double t, long double x0, long double y0, long double vx0, long double vy0)
            {IC[0] = t;
             IC[1] = x0;
             IC[2] = y0;
             IC[3] = vx0;
             IC[4] = vy0;
             
             for(int i=0; i<5; ++i)
                 u[0][i] = IC[i];
             }

      void initialIncrement(long double *inc)
          {IC[0] = 0;
           for(int i=0; i<4; ++i)
               IC[i+1] += inc[i];

           for(int i=0; i<5; ++i)
                 u[0][i] = IC[i];
           }
      
      void nextPosition(void (*f)(long double x, long double y, long double arr[]))
            {long double a[2];
             long double x = u[0][1], y=u[0][2], vx=u[0][3], vy=u[0][4];
             
             f(x, y, a);
             long double G1x = a[0];
             long double G1y = a[1];
             long double F1x = vx;
             long double F1y = vy;

             f(x+ F1x*dt/2, y+ F1y*dt/2, a);
             long double G2x = a[0];
             long double G2y = a[1];
             long double F2x = vx + G1x*dt/2;
             long double F2y = vy + G1y*dt/2;

             f(x+ F2x*dt/2, y+ F2y*dt/2, a);
             long double G3x = a[0];
             long double G3y = a[1];
             long double F3x = vx + G2x*dt/2;
             long double F3y = vy + G2y*dt/2;

             f(x+ F3x*dt, y+ F3y*dt, a);
             long double G4x = a[0];
             long double G4y = a[1];
             long double F4x = vx + G3x*dt;
             long double F4y = vy + G3y*dt;
             
             u[1][0] = u[0][0] + dt;
             u[1][3] = vx + (G1x + 2*G2x + 2*G3x + G4x)*dt/6;
             u[1][4] = vy + (G1y + 2*G2y + 2*G3y + G4y)*dt/6;
             u[1][1] = x + (F1x + 2*F2x + 2*F3x + F4x)*dt/6;
             u[1][2] = y + (F1y + 2*F2y + 2*F3y + F4y)*dt/6;
 
             for(int i=0; i<5; ++i)
                 u[0][i] = u[1][i];
             }
      };
//Numerical class ends

